#!/usr/bin/python

import socket

def retbanner(ip,port):
	try:
		socket.setdefaulttimeout(2)
		s = socket.socket()
		s.connect((ip,port))
		banner = s.recv(1024).strip('/n')
		return banner
	except:
		return

def main():
	ip = input("Enter IP to scan: ")
	for port in range(1,5000):
		banner = retbanner(ip,port)
		if banner:
			print "[+]" + ip + "/" + str(port) + ": " + banner.strip('/n')

main()
